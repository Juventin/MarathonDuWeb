<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>GeoTeev</title>
    <link rel="icon" type="image/png" href="img/star-empty.png" />

    <link rel="stylesheet" href="style.css">

    <link rel="stylesheet" href="range-slider-master/css/rSlider.min.css">
    <script src="range-slider-master/js/rSlider.min.js"></script>

    <script src="https://code.highcharts.com/maps/highmaps.js"></script>
    <script src="https://code.highcharts.com/maps/modules/data.js"></script>
    <script src="https://code.highcharts.com/maps/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/maps/modules/offline-exporting.js"></script>
    <script src="https://code.highcharts.com/mapdata/countries/fr/fr-all-all.js"></script>
  </head>
  <body>

    <!-- SIDENAV  -->
    <div id="sidenav">

        <!-- HEADER  -->
        <div id="logo">
            <img src="img/logo-white.png" style="width: 100%">
        </div>
        <div id="instructions">
            <p>Select your criterias</p>
        </div>

        <!-- CRITERES  -->
        <div id="criteriacontent">

            <!-- GENRE  -->
            <div class="criteria" id="gender">
                <h2>Gender <img src="img/down-arrow.png" class="arrow up" id="arrowgender" onclick="toggle('gender')"></h2>
                <div class="boutons" id="buttonsgender">
                    <div>
                        <img src="img/gender-female.png" id="female" class="imgbutton" onclick="select('female')">
                        <img src="img/gender-male.png" id="male" class="imgbutton" onclick="select('male')">
                    </div>
                    <div>
                        <p class="legende">Female</p><p class="legende">Male</p>
                    </div>
                </div>
            </div>

            <!-- AGE  -->
            <div class="criteria" id="age">
                <h2>Age range <img src="img/down-arrow.png" class="arrow up" id="arrowage" onclick="toggle('age')"></h2>
                <div class="boutons" id="buttonsage">

                    <div class="sliderwidget">
                        <img src="img/age-baby.png" class="imgbutton">
                        <input type="text" id="sliderage" class="slider">
                        <img src="img/age-papy.png" class="imgbutton">
                    </div>
                    <div class="slidertext">
                        <input type="text" id="minage" class="slidertextinput" value="2" onKeyUp="sliderAge.setValues(parseInt(document.getElementById('minage').value), parseInt(document.getElementById('maxage').value))">
                        <input type="text" id="maxage" class="slidertextinput" value="3" onKeyUp="sliderAge.setValues(parseInt(document.getElementById('minage').value), parseInt(document.getElementById('maxage').value))">
                    </div>

                    <img src="img/more.png" id="addage" class="addinterval" onclick="addcritere('age')">

                    <div class="sliderwidget hidden" id="widgetage2">
                        <img src="img/age-baby.png" class="imgbutton">
                        <input type="text" id="sliderage2" class="slider">
                        <img src="img/age-papy.png" class="imgbutton">
                    </div>
                    <div class="slidertext hidden" id="textage2">
                        <input type="text" id="minage2" class="slidertextinput" value="2" onKeyUp="sliderAge2.setValues(parseInt(document.getElementById('minage2').value), parseInt(document.getElementById('maxage2').value))">
                        <input type="text" id="maxage2" class="slidertextinput" value="5" onKeyUp="sliderAge2.setValues(parseInt(document.getElementById('minage2').value), parseInt(document.getElementById('maxage2').value))">
                    </div>

                </div>
            </div>

            <!-- SALAIRE  -->
            <div class="criteria" id="salary">
                <h2>Salary range <img src="img/down-arrow.png" class="arrow up" id="arrowsalary" onclick="toggle('salary')"></h2>
                <div class="boutons" id="buttonssalary">

                    <div class="sliderwidget">
                        <img src="img/salary-min.png" class="imgbutton">
                        <input type="text" id="slidersalary" class="slider">
                        <img src="img/salary-max.png" class="imgbutton">
                    </div>
                    <div class="slidertext">
                        <input type="text" id="minsalary" class="slidertextinput" value="2" onKeyUp="sliderSalary.setValues(parseInt(document.getElementById('minsalary').value), parseInt(document.getElementById('maxsalary').value))">
                        <input type="text" id="maxsalary" class="slidertextinput" value="3" onKeyUp="sliderSalary.setValues(parseInt(document.getElementById('minsalary').value), parseInt(document.getElementById('maxsalary').value))">
                    </div>

                    <img src="img/more.png" id="addsalary" class="addinterval" onclick="addcritere('salary')">

                    <div class="sliderwidget hidden" id="widgetsalary2">
                        <img src="img/salary-min.png" class="imgbutton">
                        <input type="text" id="slidersalary2" class="slider">
                        <img src="img/salary-max.png" class="imgbutton">
                    </div>
                    <div class="slidertext hidden" id="textsalary2">
                        <input type="text" id="minsalary2" class="slidertextinput" value="2" onKeyUp="sliderSalary2.setValues(parseInt(document.getElementById('minsalary2').value), parseInt(document.getElementById('maxsalary2').value))">
                        <input type="text" id="maxsalary2" class="slidertextinput" value="3" onKeyUp="sliderSalary2.setValues(parseInt(document.getElementById('minsalary2').value), parseInt(document.getElementById('maxsalary2').value))">
                    </div>
                    
                </div>
            </div>

            <!-- INTERETS  -->
            <div class="criteria" id="interests">
                <h2>Interests <img src="img/down-arrow.png" class="arrow up" id="arrowinterests" onclick="toggle('interests')"></h2>
                <div class="boutons" id="buttonsinterests">
                    <input type="text" id="searchinterests" class="interestsinput" placeholder="Search..." onkeyup="search()">
                    <ul class="formulaire" id="formulaire">
                        <li>
                            <input type="checkbox" id="arts" name="arts">
                            <label for="arts">Arts et divertissements</label>
                        </li><li>
                            <input type="checkbox" id="automobile" name="automobile">
                            <label for="automobile">Automobile</label>
                        </li><li>
                            <input type="checkbox" id="affaires" name="affaires">
                            <label for="affaires">Affaires</label>
                        </li><li>
                            <input type="checkbox" id="carrieres" name="carrieres">
                            <label for="carrieres">Carrières</label>
                        </li><li>
                            <input type="checkbox" id="education" name="education">
                            <label for="education">Éducation</label>
                        </li><li>
                            <input type="checkbox" id="famille" name="famille">
                            <label for="famille">Famille et parentalité</label>
                        </li><li>
                            <input type="checkbox" id="santé" name="santé">
                            <label for="santé">Santé et mise en forme</label>
                        </li><li>
                            <input type="checkbox" id="alimentation" name="alimentation">
                            <label for="alimentation">Alimentation et boissons</label>
                        </li><li>
                            <input type="checkbox" id="loisirs" name="loisirs">
                            <label for="loisirs">Loisirs et intérêts</label>
                        </li><li>
                            <input type="checkbox" id="maison" name="maison">
                            <label for="maison">Maison et jardin</label>
                        </li><li>
                            <input type="checkbox" id="droit" name="droit">
                            <label for="droit">Droit et politique</label>
                        </li><li>
                            <input type="checkbox" id="actualites" name="actualites">
                            <label for="actualites">Actualités</label>
                        </li><li>
                            <input type="checkbox" id="finances" name="finances">
                            <label for="finances">Finances personnelles</label>
                        </li><li>
                            <input type="checkbox" id="societe" name="societe">
                            <label for="societe">Société</label>
                        </li><li>
                            <input type="checkbox" id="sciences" name="sciences">
                            <label for="sciences">Sciences</label>
                        </li><li>
                            <input type="checkbox" id="animaux" name="animaux">
                            <label for="animaux">Animaux</label>
                        </li><li>
                            <input type="checkbox" id="sports" name="sports">
                            <label for="sports">Sports</label>
                        </li><li>
                            <input type="checkbox" id="style" name="style">
                            <label for="style">Style et mode</label>
                        </li><li>
                            <input type="checkbox" id="technologie" name="technologie">
                            <label for="technologie">Tech et informatique</label>
                        </li><li>
                            <input type="checkbox" id="voyage" name="voyage">
                            <label for="voyage">Voyage</label>
                        </li><li>
                            <input type="checkbox" id="immobilier" name="immobilier">
                            <label for="immobilier">Immobilier</label>
                        </li><li>
                            <input type="checkbox" id="shopping" name="shopping">
                            <label for="shopping">Shopping</label>
                        </li>
                    </ul>
                </div>
            </div>

        </div>
    </div>

    <!-- MAP  -->
    <div id="mapdiv">
        <p id="chargement">Loading ...</p>
    </div>



    <script>
        // SLIDERS 
        var sliderAge = new rSlider({
            target: '#sliderage',
            values: [1, 2, 3, 4, 5, 6, 7, 8],
            range: true,
            set: [2, 3],
            tooltip: false,
            width: "100px",
            labels: false,
            onChange: function(values){
                document.getElementById('minage').value = parseInt(values[0])
                document.getElementById('maxage').value = parseInt(values[2])
            }
        }); 

        var sliderAge2 = new rSlider({
            target: '#sliderage2',
            values: [1, 2, 3, 4, 5, 6, 7, 8],
            range: true,
            set: [2, 3],
            tooltip: false,
            width: "100px",
            labels: false,
            onChange: function(values){
                document.getElementById('minage2').value = parseInt(values[0])
                document.getElementById('maxage2').value = parseInt(values[2])
            }
        });

        var sliderSalary = new rSlider({
            target: '#slidersalary',
            values: [1, 2, 3, 4, 5, 6, 7, 8],
            range: true,
            set: [2, 3],
            tooltip: false,
            width: "100px",
            labels: false,
            onChange: function(values){
                document.getElementById('minsalary').value = parseInt(values[0])
                document.getElementById('maxsalary').value = parseInt(values[2])
            }
        }); 

        var sliderSalary2 = new rSlider({
            target: '#slidersalary2',
            values: [1, 2, 3, 4, 5, 6, 7, 8],
            range: true,
            set: [2, 3],
            tooltip: false,
            width: "100px",
            labels: false,
            onChange: function(values){
                document.getElementById('minsalary2').value = parseInt(values[0])
                document.getElementById('maxsalary2').value = parseInt(values[2])
            }
        });

        // Doc : https://www.cssscript.com/animated-customizable-range-slider-pure-javascript-rslider-js/
    
    
        // SELECT GENDER 
        function select(id) {
            if(document.getElementById(id).className == "imgbutton active"){
                document.getElementById(id).className = "imgbutton"
            }
            else {
                document.getElementById(id).className = "imgbutton active"
            }
        }
    

        // AJOUT CRITERE 
        function addcritere(id) {
            add = 'add'+id
            document.getElementById(add).className += " hidden";
            widget = 'widget'+id+'2'
            document.getElementById(widget).className = "sliderwidget";
            text = 'text'+id+'2'
            document.getElementById(text).className = "slidertext";
        }


        // HIDE/SHOW CRITERE 
        function toggle(idshort) {
            id = 'buttons'+idshort
            arrow = 'arrow'+idshort
            if(document.getElementById(id).className == 'boutons hidden'){
                document.getElementById(id).className = 'boutons'
                document.getElementById(arrow).className = 'arrow up'
            }
            else {
                document.getElementById(id).className = 'boutons hidden'
                document.getElementById(arrow).className = 'arrow down'
            }
        }


        // RECHERCHE INTERET 
        function search() {
            
            var input, filter, ul, li, a, i, txtValue;

            input = document.getElementById('searchinterests');
            filter = input.value.toUpperCase();
            ul = document.getElementById("formulaire");
            li = ul.getElementsByTagName("li");
            
            for (i = 0; i < li.length; i++) {
                a = li[i].getElementsByTagName("label")[0];
                txtValue = a.textContent || a.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                li[i].style.display = "";
                } else {
                li[i].style.display = "none";
                }
            }
        }


        // CHART !!

        // Ici c'est l'icone download personnalisé de Valou <3
        Highcharts.SVGRenderer.prototype.symbols.download = function (x, y, w, h) {
            var path = [
                // Arrow stem
                'M', x + w * 0.5, y,
                'L', x + w * 0.5, y + h * 0.7,
                // Arrow head
                'M', x + w * 0.3, y + h * 0.5,
                'L', x + w * 0.5, y + h * 0.7,
                'L', x + w * 0.7, y + h * 0.5,
                // Box
                'M', x, y + h * 0.9,
                'L', x, y + h,
                'L', x + w, y + h,
                'L', x + w, y + h * 0.9
            ];
            return path;
        };

        document.addEventListener('DOMContentLoaded', function () {
            var myChart = Highcharts.Map('mapdiv', {
                chart: {
                    map: 'countries/fr/fr-all-all',
                    backgroundColor: 'none'
                },
                title: {
                    text: 'Potentiel de targeting'
                },
                exporting: {
                    sourceWidth: 600,
                    sourceHeight: 500
                },

                legend: {
                    layout: 'horizontal',
                    borderWidth: 0,
                    backgroundColor: 'rgba(255,255,255,0.85)',
                    floating: true,
                    verticalAlign: 'bottom',
                    y: 25
                },
                
                mapNavigation: {
                    enabled: true
                },

                exporting: {
                    buttons: {
                        contextButton: {
                            symbol: 'download'
                        }
                    }
                },

                colorAxis: {
                    minColor: '#FFF4BE',
                    maxColor: '#e84845',
                },

                credits: {
                    enabled: false
                }

                // series: [{
                //     animation: {
                //         duration: 1000
                //     },
                //     data: data,
                //     joinBy: ['postal-code', 'code'],
                //     dataLabels: {
                //         enabled: true,
                //         color: '#FFFFFF',
                //         format: '{point.code}'
                //     },
                //     name: 'Population density',
                //     tooltip: {
                //         pointFormat: '{point.code}: {point.value}/km²'
                //     }
                // }]
            });
        });

    </script>
  </body>
</html>